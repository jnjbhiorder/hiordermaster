<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PromptCraft 365 - System Logic Visualization</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #111827; /* Tailwind gray-900 */
            color: #F9FAFB; /* Tailwind gray-50 */
        }

        .flow-card {
            background-color: #1F2937; /* Tailwind gray-800 */
            border: 1px solid #4B5563; /* Tailwind gray-600 */
            transition: all 0.3s ease;
            position: relative;
            z-index: 10;
        }

        .flow-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2);
            border-color: #38BDF8; /* Tailwind sky-400 */
        }
        
        .flow-card.highlight {
            border-color: #38BDF8; /* Tailwind sky-400 */
            box-shadow: 0 0 20px rgba(56, 189, 248, 0.5);
        }

        .flow-diamond {
            transform: rotate(45deg);
            width: 120px;
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .flow-diamond .content {
            transform: rotate(-45deg);
        }

        svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        line, path {
            stroke: #4B5563; /* Tailwind gray-600 */
            stroke-width: 2;
            transition: stroke 0.3s ease;
        }

        line.highlight, path.highlight {
             stroke: #38BDF8; /* Tailwind sky-400 */
             stroke-width: 3;
        }
        
        .modal {
            background-color: rgba(17, 24, 39, 0.8);
            backdrop-filter: blur(5px);
        }
    </style>
</head>
<body class="overflow-x-hidden">
    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-12">
            <h1 class="text-3xl md:text-4xl font-bold text-white">PromptCraft 365</h1>
            <p class="text-lg text-gray-400 mt-2">ì¸í„°ë™í‹°ë¸Œ ì‹œìŠ¤í…œ ë¡œì§ ì‹œê°í™”</p>
        </header>

        <div id="flow-container" class="relative min-h-screen">
            <svg id="flow-svg"></svg>
            
            <!-- Start & User Check -->
            <div id="start" class="flow-card rounded-lg p-4 w-48 text-center mx-auto cursor-pointer" data-title="ì‹œì‘" data-description="ì‚¬ìš©ìê°€ PromptCraft 365 ì—ì´ì „íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. ëª¨ë“  í”„ë¡œì„¸ìŠ¤ëŠ” ì—¬ê¸°ì„œ ì‹œì‘ë©ë‹ˆë‹¤.">
                ğŸš€ ì—ì´ì „íŠ¸ ì‹¤í–‰
            </div>
            
            <div id="check-db" class="flow-card flow-diamond mx-auto mt-24 cursor-pointer" data-title="ì‚¬ìš©ì êµ¬ë¶„" data-description="ì‹œìŠ¤í…œì€ User Profile DBë¥¼ í™•ì¸í•˜ì—¬ ì‚¬ìš©ìì˜ ì •ë³´ê°€ ì €ì¥ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ìµœì´ˆ ì‚¬ìš©ìì™€ ê¸°ì¡´ ì‚¬ìš©ìë¥¼ êµ¬ë¶„í•©ë‹ˆë‹¤.">
                <div class="content text-center text-sm">User Profile<br>ì¡´ì¬?</div>
            </div>

            <!-- Flow 1: New User Onboarding -->
            <div class="mt-24">
                <p class="text-center text-sky-400 font-bold mb-4">- ìµœì´ˆ ì‚¬ìš©ì (Onboarding) -</p>
                <div class="grid grid-cols-1 md:grid-cols-5 gap-y-24 md:gap-y-0 md:gap-x-8 items-center">
                    <div id="survey" class="flow-card rounded-lg p-4 text-center cursor-pointer" data-title="1. ì„ í˜¸ë„ ì¡°ì‚¬" data-description="ì‚¬ìš©ìì˜ ê¸€ì“°ê¸° ìŠ¤íƒ€ì¼ì„ íŒŒì•…í•˜ê¸° ìœ„í•´ A/B í…ŒìŠ¤íŠ¸ í˜•ì‹ì˜ ì„¤ë¬¸ì„ ì§„í–‰í•©ë‹ˆë‹¤. (ê²©ì‹, ì–´ì¡°, êµ¬ì¡°, ì–´íœ˜)">A/B í…ŒìŠ¤íŠ¸ ì„¤ë¬¸</div>
                    <div id="consent" class="flow-card rounded-lg p-4 text-center cursor-pointer" data-title="2. ë°ì´í„° ì ‘ê·¼ ë™ì˜" data-description="ê°œì¸í™” ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ìƒì„±ì„ ìœ„í•´ M365 ë°ì´í„°(ì´ë©”ì¼/ë¬¸ì„œ) ì ‘ê·¼ì— ëŒ€í•œ ì‚¬ìš©ì ë™ì˜ë¥¼ ë°›ìŠµë‹ˆë‹¤.">M365 ì ‘ê·¼ ë™ì˜</div>
                    <div id="analysis" class="flow-card rounded-lg p-4 text-center cursor-pointer" data-title="3. ë°ì´í„° ë¶„ì„" data-description="ì‚¬ìš©ìê°€ ë™ì˜í•˜ë©´, MS Graph APIë¥¼ í†µí•´ ìµœê·¼ 3ê°œì›”ê°„ì˜ ì´ë©”ì¼ ë° ë¬¸ì„œë¥¼ ë¶„ì„í•˜ì—¬ ì•”ë¬µì ì¸ ê¸€ì“°ê¸° íŒ¨í„´ì„ ì¶”ì¶œí•©ë‹ˆë‹¤.">ë°ì´í„° ë¶„ì„</div>
                    <div id="generate" class="flow-card rounded-lg p-4 text-center bg-sky-900/50 border-sky-500 cursor-pointer" data-title="4. ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ìƒì„± (í•µì‹¬)" data-description="ì„¤ë¬¸ ê²°ê³¼(ëª…ì‹œì  ì„ í˜¸)ì™€ ë°ì´í„° ë¶„ì„(ì•”ë¬µì  íŒ¨í„´)ì„ ê²°í•©í•˜ì—¬ ì‚¬ìš©ìì—ê²Œ ìµœì í™”ëœ ê°œì¸í™” ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.">âœ¨ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ìƒì„±</div>
                    <div id="save" class="flow-card rounded-lg p-4 text-center cursor-pointer" data-title="5. í”„ë¡œí•„ ì €ì¥" data-description="ìƒì„±ëœ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ë¥¼ User Profile DBì— ì•ˆì „í•˜ê²Œ ì €ì¥í•˜ì—¬ ë‹¤ìŒ ì‹¤í–‰ë¶€í„° ì¦‰ì‹œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.">DBì— ì €ì¥</div>
                </div>
            </div>

             <!-- Flow 2: Existing User Prompt Processing -->
            <div class="mt-32">
                 <p class="text-center text-emerald-400 font-bold mb-4">- ê¸°ì¡´ ì‚¬ìš©ì (Prompt ì²˜ë¦¬) -</p>
                 <div class="grid grid-cols-1 md:grid-cols-3 gap-y-24 md:gap-y-0 md:gap-x-8 items-center">
                    <div id="load" class="flow-card rounded-lg p-4 text-center cursor-pointer" data-title="1. ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ë¡œë“œ" data-description="DBì— ì €ì¥ëœ ì‚¬ìš©ìì˜ ê°œì¸í™” ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ë¥¼ ì¦‰ì‹œ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.">DBì—ì„œ í”„ë¡¬í”„íŠ¸ ë¡œë“œ</div>
                    <div id="input" class="flow-card rounded-lg p-4 text-center cursor-pointer" data-title="2. í”„ë¡¬í”„íŠ¸ ì…ë ¥" data-description="ì‚¬ìš©ìëŠ” í‰ì†Œì²˜ëŸ¼ ìì—°ìŠ¤ëŸ½ê²Œ AIì—ê²Œ ìš”ì²­í•  í”„ë¡¬í”„íŠ¸ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.">ì‚¬ìš©ì í”„ë¡¬í”„íŠ¸ ì…ë ¥</div>
                    <div id="process" class="flow-card rounded-lg p-4 text-center bg-emerald-900/50 border-emerald-500 cursor-pointer" data-title="3. í”„ë¡¬í”„íŠ¸ ë³‘ë ¬ ì²˜ë¦¬ (í•µì‹¬)" data-description="ì…ë ¥ëœ í”„ë¡¬í”„íŠ¸ë¥¼ [ì›ë³¸]ê³¼ [ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸+ì›ë³¸] ë‘ ê²½ë¡œë¡œ ë‚˜ëˆ„ì–´ AI ëª¨ë¸ì— ë™ì‹œì— ìš”ì²­í•©ë‹ˆë‹¤.">âš¡ í”„ë¡¬í”„íŠ¸ ë³‘ë ¬ ì²˜ë¦¬</div>
                 </div>
                 <div class="mt-24 grid grid-cols-1 md:grid-cols-2 gap-8 md:w-2/3 mx-auto">
                     <div id="call-a" class="flow-card rounded-lg p-4 text-center cursor-pointer" data-title="Call A (ì›ë³¸)" data-description="ì‚¬ìš©ìê°€ ì…ë ¥í•œ ì›ë³¸ í”„ë¡¬í”„íŠ¸ë¥¼ ê·¸ëŒ€ë¡œ AI ëª¨ë¸ì— ì „ë‹¬í•˜ì—¬ ê²°ê³¼ë¬¼ì„ ìƒì„±í•©ë‹ˆë‹¤.">Call A: ì›ë³¸ í”„ë¡¬í”„íŠ¸</div>
                     <div id="call-b" class="flow-card rounded-lg p-4 text-center cursor-pointer" data-title="Call B (ê°œì„ )" data-description="ê°œì¸í™” ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ì™€ ì›ë³¸ í”„ë¡¬í”„íŠ¸ë¥¼ ê²°í•©í•˜ì—¬ AI ëª¨ë¸ì— ì „ë‹¬í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì‚¬ìš©ì ë§ì¶¤í˜• ê²°ê³¼ë¬¼ì„ ìƒì„±í•©ë‹ˆë‹¤.">Call B: ê°œì„ ëœ í”„ë¡¬í”„íŠ¸</div>
                 </div>
                 <div id="result" class="flow-card rounded-lg p-6 text-center mt-24 md:w-1/2 mx-auto cursor-pointer" data-title="ìµœì¢… ê²°ê³¼" data-description="ë‘ AIì˜ ê²°ê³¼ë¬¼ì„ ì¢Œ/ìš°ë¡œ ë‚˜ë€íˆ ë¹„êµí•˜ì—¬ ë³´ì—¬ì¤ë‹ˆë‹¤. ì‚¬ìš©ìëŠ” ë‘ ê²°ê³¼ë¬¼ì„ ë¹„êµí•˜ë©° ìì—°ìŠ¤ëŸ½ê²Œ ì¢‹ì€ í”„ë¡¬í”„íŠ¸ì˜ ì›ë¦¬ë¥¼ í•™ìŠµí•˜ê²Œ ë©ë‹ˆë‹¤.">ê²°ê³¼ ë¹„êµ UI í‘œì‹œ</div>
            </div>
        </div>
    </div>
    
    <!-- Modal -->
    <div id="modal" class="fixed inset-0 z-50 items-center justify-center hidden">
        <div class="modal absolute inset-0"></div>
        <div class="relative w-11/12 max-w-md bg-gray-800 rounded-lg shadow-lg p-6 border border-gray-600">
            <h3 id="modal-title" class="text-xl font-bold text-sky-400 mb-2"></h3>
            <p id="modal-description" class="text-gray-300"></p>
            <button id="modal-close" class="absolute top-4 right-4 text-gray-400 hover:text-white">&times;</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const svg = document.getElementById('flow-svg');
            const container = document.getElementById('flow-container');
            
            const connections = [
                // Start to Check
                { from: 'start', to: 'check-db', type: 'line', style: 'straight' },
                
                // Onboarding Path
                { from: 'check-db', to: 'survey', type: 'path', style: 'elbow-left', text: 'NO' },
                { from: 'survey', to: 'consent', type: 'line', style: 'straight' },
                { from: 'consent', to: 'analysis', type: 'line', style: 'straight' },
                { from: 'analysis', to: 'generate', type: 'line', style: 'straight' },
                { from: 'generate', to: 'save', type: 'line', style: 'straight' },
                
                // Existing User Path
                { from: 'check-db', to: 'load', type: 'path', style: 'elbow-right', text: 'YES' },
                { from: 'load', to: 'input', type: 'line', style: 'straight' },
                { from: 'input', to: 'process', type: 'line', style: 'straight' },
                { from: 'process', to: 'call-a', type: 'path', style: 'split-left' },
                { from: 'process', to: 'call-b', type: 'path', style: 'split-right' },
                { from: 'call-a', to: 'result', type: 'path', style: 'merge-left' },
                { from: 'call-b', to: 'result', type: 'path', style: 'merge-right' },
            ];

            function getElCenter(el) {
                const rect = el.getBoundingClientRect();
                const containerRect = container.getBoundingClientRect();
                return {
                    x: rect.left - containerRect.left + rect.width / 2,
                    y: rect.top - containerRect.top + rect.height / 2,
                    top: { x: rect.left - containerRect.left + rect.width / 2, y: rect.top - containerRect.top },
                    bottom: { x: rect.left - containerRect.left + rect.width / 2, y: rect.bottom - containerRect.top },
                    left: { x: rect.left - containerRect.left, y: rect.top - containerRect.top + rect.height / 2 },
                    right: { x: rect.right - containerRect.left, y: rect.top - containerRect.top + rect.height / 2 },
                };
            }

            function drawLines() {
                svg.innerHTML = ''; // Clear previous lines
                const marker = document.createElementNS('http://www.w3.org/2000/svg', 'marker');
                marker.setAttribute('id', 'arrow');
                marker.setAttribute('viewBox', '0 0 10 10');
                marker.setAttribute('refX', '8');
                marker.setAttribute('refY', '5');
                marker.setAttribute('markerWidth', '6');
                marker.setAttribute('markerHeight', '6');
                marker.setAttribute('orient', 'auto-start-reverse');
                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                path.setAttribute('d', 'M 0 0 L 10 5 L 0 10 z');
                path.setAttribute('fill', '#4B5563');
                marker.appendChild(path);
                
                const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');
                defs.appendChild(marker);
                svg.appendChild(defs);

                connections.forEach(conn => {
                    const fromEl = document.getElementById(conn.from);
                    const toEl = document.getElementById(conn.to);
                    if (!fromEl || !toEl) return;

                    const from = getElCenter(fromEl);
                    const to = getElCenter(toEl);
                    
                    let line;
                    if (conn.type === 'line') {
                        line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                        line.setAttribute('x1', from.bottom.x);
                        line.setAttribute('y1', from.bottom.y);
                        line.setAttribute('x2', to.top.x);
                        line.setAttribute('y2', to.top.y);
                    } else { // path for elbows
                        line = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                        let pathData;
                        const midY = from.y + (to.y - from.y) / 2;
                        
                        switch(conn.style) {
                            case 'elbow-left':
                                pathData = `M ${from.left.x} ${from.left.y} L ${to.right.x} ${to.right.y}`;
                                break;
                            case 'elbow-right':
                                pathData = `M ${from.right.x} ${from.right.y} L ${to.left.x} ${to.left.y}`;
                                break;
                            case 'split-left':
                                pathData = `M ${from.bottom.x} ${from.bottom.y} V ${midY} H ${to.top.x} V ${to.top.y}`;
                                break;
                             case 'split-right':
                                pathData = `M ${from.bottom.x} ${from.bottom.y} V ${midY} H ${to.top.x} V ${to.top.y}`;
                                break;
                            case 'merge-left':
                                pathData = `M ${from.bottom.x} ${from.bottom.y} V ${midY} H ${to.top.x} V ${to.top.y}`;
                                break;
                            case 'merge-right':
                                pathData = `M ${from.bottom.x} ${from.bottom.y} V ${midY} H ${to.top.x} V ${to.top.y}`;
                                break;
                            default:
                                line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                                line.setAttribute('x1', from.bottom.x); line.setAttribute('y1', from.bottom.y);
                                line.setAttribute('x2', to.top.x); line.setAttribute('y2', to.top.y);

                        }
                        if (pathData) {
                            line.setAttribute('d', pathData);
                            line.setAttribute('fill', 'none');
                        }
                    }
                    
                    line.setAttribute('marker-end', 'url(#arrow)');
                    line.id = `line-${conn.from}-${conn.to}`;
                    svg.appendChild(line);
                });
            }

            const cards = document.querySelectorAll('.flow-card');
            cards.forEach(card => {
                card.addEventListener('mouseenter', () => {
                    const fromId = card.id;
                    connections.forEach(conn => {
                        if (conn.from === fromId || conn.to === fromId) {
                           document.getElementById(`line-${conn.from}-${conn.to}`)?.classList.add('highlight');
                           document.getElementById(conn.from)?.classList.add('highlight');
                           document.getElementById(conn.to)?.classList.add('highlight');
                        }
                    });
                });
                card.addEventListener('mouseleave', () => {
                    document.querySelectorAll('.highlight').forEach(el => el.classList.remove('highlight'));
                });
                
                // Modal logic
                card.addEventListener('click', () => {
                    document.getElementById('modal-title').innerText = card.dataset.title;
                    document.getElementById('modal-description').innerText = card.dataset.description;
                    document.getElementById('modal').style.display = 'flex';
                });
            });

            const modal = document.getElementById('modal');
            const modalClose = document.getElementById('modal-close');
            modal.addEventListener('click', (e) => {
                if (e.target === modal || e.target === modalClose) {
                    modal.style.display = 'none';
                }
            });

            window.addEventListener('resize', drawLines);
            // Use a timeout to ensure all elements are rendered before drawing
            setTimeout(drawLines, 100); 
        });
    </script>
</body>
</html>
